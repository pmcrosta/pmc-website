[
  {
    "objectID": "research/building_a_dataset.html",
    "href": "research/building_a_dataset.html",
    "title": "Building a dataset",
    "section": "",
    "text": "To gain a better understanding of the current state of education in Fair Haven, I started by building a data set. This document shares the process I went through to combine state and federal resources to generate data sets that would enable an analysis of student outcomes, educational inputs, and their relationship over time. The process also includes a discussion of how I created a set of suitable comparison school districts for Fair Haven.\nIn an effort to be as transparent as possible, this document contains descriptions of source and derived data sets as well as code in the R programming language that one can use to reproduce results.\n\n\nCode - Load libraries\noptions(width = 120)\n\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(googlesheets4)\nlibrary(googledrive)\nlibrary(haven)\nlibrary(cluster)\nlibrary(MASS)\nlibrary(ggpmisc)\nlibrary(ggrepel)\nlibrary(ggfortify)\nlibrary(glue)\nlibrary(DT)\nlibrary(htmltools)\nlibrary(factoextra)\nlibrary(gt)\nlibrary(purrr)\n\nset.seed(2024)\n\n# Commonly used State ID numbers (staid) and Federal Local Education Authority (LEA) IDs\n# for FH, Little Silver, Rumson, and Shrewsbury\nfh_leaid &lt;- \"3404950\"\nfh_staid &lt;- \"NJ-251440\"\n\nls_leaid &lt;- \"3408790\"\nls_staid &lt;- \"NJ-252720\"\n\nrums_leaid &lt;- \"3414370\"\nrums_staid &lt;- \"NJ-254570\"\n\nshrews_leaid &lt;- \"3414970\"\nshrews_staid &lt;- \"NJ-254770\"\n\ndistrict_name_colors &lt;- c(\n  \"Fair Haven Boro\" = \"#4169E1\",\n  \"Little Silver Boro\" = \"#1F2868\",\n  \"Rumson Boro\" = \"#8640C4\",\n  \"Shrewsbury Boro\" = \"#004500\",\n  \"Other\" = \"darkgrey\"\n)"
  },
  {
    "objectID": "research/building_a_dataset.html#approaches",
    "href": "research/building_a_dataset.html#approaches",
    "title": "Building a dataset",
    "section": "Approaches",
    "text": "Approaches\nI leverage a number of techniques to generate peer districts for Fair Haven using these data. This exercise is both an art and science, as it is both grounded in data and subject to a number of researcher choices. To that end, a few sets of comparison districts will be created. Note that the final comparison data sets will be filtered to only include PK-8 districts like Fair Haven; this will happen later though since it requires yet another data source. In addition, the following section is not a “full academic” treatment of these approaches, meaning that the primary end is to be useful, not necessarily to fully account for all methodological nuances. However, I will compare district characteristics across various peer sets.\n\nEuclidean distance\nOne simple, albeit somewhat naive, approach to identifying peer districts is to find the districts that are “closest” to each other given the district characteristics that were identified above. To do this, I\n\nStandardize all of our variables\nCompute a distance matrix (Euclidean distance in multidimensional space)\nRank districts in terms of their “proximity” to Fair Haven\n\nOne downside to this strategy is that there are a number of highly correlated variables in the data set, and the distance matrix may overweight importance of these characteristics. For example, there are a number of income-based measures, and thus this approach may over-index on the household incomes of district residents. However, it may also produce a reasonable peer set.\n\n\nCode - Using Euclidean distance\n# Standardize variables\nedge_df_scale &lt;- scale(edge_df[,-c(1:3)])\nrownames(edge_df_scale) &lt;- edge_df$LEAID\n\n## compute the distance matrix\nedge_dist &lt;- dist(edge_df_scale, method = \"euclidean\")\n\n# Find the indices of the closest districts\nclosest_indices_euclid &lt;- order(as.matrix(edge_dist)[, which(attr(edge_dist, \"Labels\")==fh_leaid)])\n\n# Reorder edge_df so the most similar districts are on top\nsimilar_districts_euclid &lt;- edge_df[closest_indices_euclid, ] %&gt;% dplyr::mutate(euclid_score=1:n()) %&gt;% dplyr::select(LEAID, Geography, euclid_score)\n\n# Print table\ndatatable(similar_districts_euclid,\n  options = list(\n    pageLength = 5,\n    searching = TRUE,\n    ordering = TRUE\n  ),\n  rownames = FALSE,\n  caption = tags$caption(\n    style = \"caption-side: top; text-align: center;\",\n    \"Most similar districts by Euclidean distance\")\n)\n\n\n\n\n\n\n\n\nMahalanobis distance\nA second smiple distance-based approach is to use the Mahalanobis distance, as it is capable of taking into coniderations the correlations present in the data set. To do this, I\n\nStandardize all of our variables\nCompute a distance matrix (Mahalanobis pairwise distances)\nRank districts in terms of their “proximity” to Fair Haven\n\n\n\nCode - Using Mahalanobis distance\n# Standardize variables\nedge_df_scale &lt;- scale(edge_df[,-c(1:3)])\nrownames(edge_df_scale) &lt;- edge_df$LEAID\n\nmahalanobis_dist_matrix &lt;- function(data) {\n  cov_matrix &lt;- cov(data)\n  n &lt;- nrow(data)\n  dist_matrix &lt;- matrix(0, nrow = n, ncol = n)\n\n  for (i in 1:n) {\n    for (j in 1:n) {\n      dist_matrix[i, j] &lt;- mahalanobis(data[i, ], data[j, ], cov_matrix)\n    }\n  }\n  return(dist_matrix)\n}\n\n## compute the distance matrix\ndist_mat_mah &lt;- mahalanobis_dist_matrix(na.omit(edge_df_scale))\nrownames(dist_mat_mah) &lt;- dimnames(na.omit(edge_df_scale))[[1]]\n\n# Find the indices of the closest districts\nclosest_indices_mah &lt;- order(as.matrix(dist_mat_mah)[, which(rownames(dist_mat_mah)==fh_leaid)])\n\n# Print the most similar districts\nsimilar_districts_mah &lt;- (edge_df %&gt;% dplyr::filter(LEAID %in% rownames(dist_mat_mah))) [closest_indices_mah, ] %&gt;% dplyr::mutate(mah_score=1:n()) %&gt;% dplyr::select(LEAID, Geography, mah_score)\n\n# Print table\ndatatable(similar_districts_mah,\n  options = list(\n    pageLength = 5,\n    searching = TRUE,\n    ordering = TRUE\n  ),\n  rownames = FALSE,\n  caption = tags$caption(\n    style = \"caption-side: top; text-align: center;\",\n    \"Most similar districts by Mahalanobis distance\")\n)\n\n\n\n\n\n\n\n\nPrincipal Components\nAnother strategy for identifying peer districts is a dimensionality reduction technique called Principal Components Analysis. This is actually the same technique used to develop the original District Factor Groups. Though here I am using more data and more recent data. The central idea is to reduce our 40-dimensional (40-column) data set into a smaller set of components (or dimensions) that are maximally different from each other and uncorrelated with each other. These new components would contain the essence of the larger set of columns. As in the DFG calculation, I expect the first principal component to contain the variance associated with socioeconomic status (SES).\nThe general procedure is to:\n\nCompute the principal components on the data set\nAssess which dimensions load in which principal components\nRank order component of interest, and find districts surrounding Fair Haven\n\nIf the first one or two components is not sufficient, we are in clustering territory, which will be addressed later.\n\n\nCode - Using Principal Components\n# Perform PCA\npcadat &lt;- na.omit(edge_df[,-c(1:3)])\nrownames(pcadat) &lt;- make.unique(na.omit(edge_df)$Geography)\npca_result &lt;- prcomp(pcadat, scale.=T, center = T)\n\n#round(pca_result$sdev^2/sum(pca_result$sdev^2), 2) #first two ~49% variance, 37+12\n\n# Extract principal components\npc_all_scores &lt;- pca_result$x\n\n#Visualize the reduced data\n#autoplot(pca_result, data = pcadat, label = TRUE, label.size = 3)\n\n# Get loadings\npca_loadings &lt;- pca_result$rotation\n\n# Transform loadings into a long format data frame\nloadings_df &lt;- as.data.frame(pca_loadings)\nloadings_df$Variable &lt;- rownames(pca_loadings)\nloadings_long &lt;- reshape2::melt(loadings_df, id.vars = \"Variable\", variable.name = \"PC\", value.name = \"Loading\")\n\n\nIn Figure 1, it is clear that Component 1 (PC1) is loading on income and education dimensions, which are qualitatively aligned with SES. However, Component 2 (PC2) is loading on other potentially relevant dimensions, such as family size and the population under 18. Note the differences below in the districts that surround Fair Haven for both PC1 and PC2.\n\nPCA HeatmapPC1 PeersPC2 Peers\n\n\n\n\nCode\n# Create heatmap\nggplot(loadings_long %&gt;% filter(PC %in% c(\"PC1\", \"PC2\")), aes(x = PC, y = Variable, fill = Loading)) +\n  geom_tile() +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"orange\") +\n  theme_minimal() +\n  labs(title = \"PCA Loadings\", x=\"\", y=\"\")\n\n\n\n\n\n\n\n\nFigure 1: Loadings from first two components of the PCA.\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\nClustering\nA final approach to identifying peer districts is cluster analysis. Cluster analysis leverages distance functions to separate districts based on similarity, with the goal of creating groups of high similarity within clusters and high dissimilarity between clusters. I will explore both K-means and hierarchical clustering techniques, looking at a few examples of each.\n\nK-means clusters\nK-means clustering requires a distance matrix as input, and I have already created Euclidean and Mahalanobis distance matrices. I can also apply distance calculations to the PCA results in order to generate clusters based on the reduced dimensionality provided by principal components. Both scaled and un-scaled PCA results are clustered. The un-scaled version should over-weight PC1, and the scaled version should treat PC1 and PC2 more equally. The tabs below show the resulting peer groups from a standard K-means routine that assumes 7 clusters (a full treatment of K-means that searches for the optimal number of clusters is omitted in this document). Each tab includes a list of districts that were clustered alongside Fair Haven given the particular distance matrix as input.\n\n\nCode - K-means clustering\n## distance matrix from earlier\n# Euclidean: edge_dist (557)\n# Mahalanobis: dist_mat_mah (555)\n# PCA: pc_all_scores (needs dist, scaled and unscaled) (555)\n\n# Scale the principal component scores\nscaled_pc_scores &lt;- scale(pc_all_scores[,c(1:2)])\npc_dist_scaled &lt;- dist(scaled_pc_scores)\npc_dist_unscaled &lt;- dist(pc_all_scores[,c(1:2)])\n\n# Apply k-means\nn_clusters &lt;- 6\nkm_pc_scaled &lt;- kmeans(pc_dist_scaled, centers = n_clusters)\nkm_pc_unscaled &lt;- kmeans(pc_dist_unscaled, centers = n_clusters)\nkm_euclid &lt;- kmeans(edge_dist, centers = n_clusters)\nkm_maha &lt;- kmeans(dist_mat_mah, centers = n_clusters)\n\n# Access cluster assignments\nclusters_pc_scaled &lt;- km_pc_scaled$cluster\nclusters_pc_unscaled &lt;- km_pc_unscaled$cluster\nclusters_euclid &lt;- km_euclid$cluster\nclusters_maha &lt;- km_maha$cluster\n\nfh_pc_scaled &lt;- clusters_pc_scaled[\"Fair Haven Borough School District, NJ\"]\nfh_pc_unscaled &lt;- clusters_pc_unscaled[\"Fair Haven Borough School District, NJ\"]\nfh_euclid &lt;- clusters_euclid[fh_leaid]\nfh_maha &lt;- clusters_maha[fh_leaid]\n\nmat_pc_scaled &lt;- as_tibble(names(clusters_pc_scaled[clusters_pc_scaled==fh_pc_scaled])) %&gt;% rename(\"PC Scaled\"=value)\nmat_pc_unscaled &lt;- as_tibble(names(clusters_pc_unscaled[clusters_pc_unscaled==fh_pc_unscaled]))  %&gt;% rename(\"PC Unscaled\"=value)\nmat_euclid &lt;- as_tibble(names(clusters_euclid[clusters_euclid==fh_euclid]))  %&gt;% rename(\"Euclidean\"=value) %&gt;%\n  dplyr::left_join(edge_df %&gt;% dplyr::select(Geography, LEAID) %&gt;% mutate(LEAID=as.character(LEAID)), by = c(\"Euclidean\"=\"LEAID\"))\nmat_maha &lt;- as_tibble(names(clusters_maha[clusters_maha==fh_maha]))  %&gt;% rename(\"Mahalanobis\"=value) %&gt;%\n  dplyr::left_join(edge_df %&gt;% dplyr::select(Geography, LEAID) %&gt;% mutate(LEAID=as.character(LEAID)), by = c(\"Mahalanobis\"=\"LEAID\"))\n\n\n\nEuclideanMahalanobisPC ScaledPC Unscaled\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\nHierarchical\nAnother clustering strategy is called Hierarchical Clustering, which generates a full tree of districts based on similarity. One advantage of this technique is that one does not have to determine a priori how many clusters there are in the data. The tree can be cut at any level in order to find clusters of appropriate size.\nAs with K-means, the input to the hierarchical clustering routine is a distance matrix. There is another parameter included in the model to instruct how the clustering algorithm should combine districts with each other and with groups. This is often called the “method”, and here will explore a few methods. Again as with K-means, a full treatment of cluster analysis is not provided here. Rather, this exercise is to generate candidate sets of peers that will be qualitatively assessed in the next section.\nThe first tab below shows a partial dendrogram highlighting part of the full tree that contains a decent-sized cluster around Fair Haven. The other two tabs show the resulting peer groups from different clustering inputs.\n\n\nCode - Hierarchical clustering\nfind_min_cluster &lt;- function(hc, target_observation = \"Fair Haven Borough\", min_size = 50, verbose=FALSE) {\n  # Function to find where to cut tree to generate smallest cluster with FH that has at least 50 districts\n  n &lt;- length(hc$labels)\n  min_k &lt;- NULL\n  min_cluster_size &lt;- Inf \n\n  for (k in 2:n) {\n    clusters &lt;- cutree(hc, k = k)\n    target_cluster &lt;- clusters[names(clusters) == target_observation]\n    cluster_members &lt;- names(clusters[clusters == target_cluster])\n    cluster_size &lt;- length(cluster_members)\n\n    if (cluster_size &gt;= min_size && cluster_size &lt; min_cluster_size) {\n      min_k &lt;- k\n      min_cluster_size &lt;- cluster_size\n    }\n  }\n\n  final_clusters &lt;- cutree(hc, k = min_k)\n  \n  \n  if (!is.null(final_clusters)) {\n    \n    # Check the size of the cluster that \"Fair Haven Borough\" belongs to.\n    target_cluster &lt;- final_clusters[names(final_clusters) == target_observation]\n    cluster_members &lt;- names(final_clusters[final_clusters == target_cluster]) # contains peers\n    if (verbose) {\n      print(paste(\"Size of cluster containing Fair Haven Borough:\", length(cluster_members)))\n      print(paste(\"Number of Clusters:\", length(unique(final_clusters))))\n    }\n  } else {\n    if (verbose) print(\"No cluster found with size &gt;= 50 containing Fair Haven Borough.\")\n  }\n\n  \n  if (!is.null(min_k)) {\n    return(list(final_clusters=final_clusters, target_cluster=target_cluster, cluster_members=cluster_members))\n  } else {\n    return(NULL)\n  }\n}\n\n# Distance matrices:\n#   pc_dist_scaled\n#   pc_dist_unscaled\n#   edge_dist\n#   dist_mat_mah (SKIP_)\n\n# Hierarchical clustering using Ward and WPGMA Linkage\n\n## Euclidean\nhc_euclid_ward &lt;- hclust(edge_dist, method = \"ward.D2\" )\nhc_euclid_mcquitty &lt;- hclust(edge_dist, method=\"mcquitty\")\n\nhc_euclid_ward_clusters &lt;- find_min_cluster(hc_euclid_ward, min_size = 50, target_observation = fh_leaid)\nhc_euclid_mcquitty_clusters &lt;- find_min_cluster(hc_euclid_mcquitty, min_size = 50, target_observation = fh_leaid)\n\n## PC scaled\nhc_pc_dist_scaled_ward &lt;- hclust(pc_dist_scaled, method = \"ward.D2\" )\nhc_pc_dist_scaled_mcquitty &lt;- hclust(pc_dist_scaled, method=\"mcquitty\")\n\nhc_pc_dist_scaled_ward_clusters &lt;- find_min_cluster(hc_pc_dist_scaled_ward, min_size = 50, target_observation = \"Fair Haven Borough School District, NJ\")\nhc_pc_dist_scaled_mcquitty_clusters &lt;- find_min_cluster(hc_pc_dist_scaled_mcquitty, min_size = 50, target_observation = \"Fair Haven Borough School District, NJ\")\n\n## PC unscaled\nhc_pc_dist_unscaled_ward &lt;- hclust(pc_dist_unscaled, method = \"ward.D2\" )\nhc_pc_dist_unscaled_mcquitty &lt;- hclust(pc_dist_unscaled, method=\"mcquitty\")\n\nhc_pc_dist_unscaled_ward_clusters &lt;- find_min_cluster(hc_pc_dist_unscaled_ward, min_size = 50, target_observation = \"Fair Haven Borough School District, NJ\")\nhc_pc_dist_unscaled_mcquitty_clusters &lt;- find_min_cluster(hc_pc_dist_unscaled_mcquitty, min_size = 40, target_observation = \"Fair Haven Borough School District, NJ\")\n\n\n\nDendrogramEuclidean Ward PeersPC Unscaled Ward Peers\n\n\n\n\nCode\n# visualize the tree\n# fviz_dend(hc_euclid_ward, k = 4, color_labels_by_k = TRUE, cex=.1, type=\"circular\")\n\nviztree &lt;- function(datain, members, distfun, clustfun) {\n  datain &lt;- datain %&gt;%\n    dplyr::filter(LEAID %in% members)\n  \n  datain_scale &lt;- scale(datain[,-c(1:3)])\n  rownames(datain_scale) &lt;- datain$LEAID\n\n  datain_dist &lt;- dist(datain_scale, method = distfun)\n  \n  newclust &lt;- hclust(datain_dist, method = \"ward.D2\" )\n  newclust$labels &lt;- gsub(\" School District, NJ\", \"\", datain$Geography)\n  \n  fviz_dend(newclust, cex=.4, horiz=T)\n}\n\nviztree(edge_df, hc_euclid_ward_clusters$cluster_members, \"euclidean\", \"ward.D2\")\n\n\n\n\n\n\n\n\nFigure 2: Partial dendrogram from Ward clustering (Euclidean)\n\n\n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\n\n\n  \n\n\n\n\n\n\nFinally, I add the possible peer sets back to our CCD data set and save them as a CSV file for easy access.\n\n\nCode - Update data with peer sets\n# Create K-means cluster indicators in edge_df\nedge_df &lt;- edge_df %&gt;% \n  dplyr::mutate(\n    km_euclid = LEAID %in% mat_euclid$Euclidean,\n    km_maha = LEAID %in% mat_maha$Mahalanobis,\n    km_pc_scaled = Geography %in% mat_pc_scaled$`PC Scaled`,\n    km_pc_unscaled = Geography %in% mat_pc_unscaled$`PC Unscaled`\n  )\n  \n# Create hierarchical cluster indicators in edge_df\nedge_df &lt;- edge_df %&gt;% \n  dplyr::mutate(\n    hc_euclid_ward = LEAID %in% hc_euclid_ward_clusters$cluster_members,\n    hc_euclid_mcquitty = LEAID %in% hc_euclid_mcquitty_clusters$cluster_members,\n    hc_pc_dist_scaled_ward = Geography %in% hc_pc_dist_scaled_ward_clusters$cluster_members,\n    hc_pc_dist_scaled_mcquitty = Geography %in% hc_pc_dist_scaled_mcquitty_clusters$cluster_members,\n    hc_pc_dist_unscaled_ward = Geography %in% hc_pc_dist_unscaled_ward_clusters$cluster_members,\n    hc_pc_dist_unscaled_mcquitty = Geography %in% hc_pc_dist_unscaled_mcquitty_clusters$cluster_members,\n    LEAID = as.character(LEAID)\n    )\n\n# add peer options to \nccdnjk12_peers &lt;- ccdnjk12 %&gt;% dplyr::mutate(LEAID = as.character(LEAID)) %&gt;%\n  dplyr::left_join(edge_df %&gt;% dplyr::mutate(LEAID = as.character(LEAID)), by = \"LEAID\") %&gt;%\n  dplyr::left_join(similar_districts_euclid %&gt;% dplyr::select(-Geography) %&gt;% dplyr::mutate(LEAID = as.character(LEAID)), by = \"LEAID\") %&gt;%\n  dplyr::left_join(similar_districts_mah %&gt;% dplyr::select(-Geography) %&gt;% dplyr::mutate(LEAID = as.character(LEAID)), by = \"LEAID\") %&gt;%\n  dplyr::left_join(pc_all_scores_df %&gt;%\n                     dplyr::select(LEAID, PC1, PC2) %&gt;%\n                     dplyr::mutate(LEAID = as.character(LEAID)), by = \"LEAID\")\n \n# Serialize\nwrite_csv(ccdnjk12_peers, file=\"datasets/ccdnjk12_peers.csv\")\n\n\n\n\n\nComparing Peer Sets\nThus far, I have created a number of candidate peer groups for Fair Haven. In fact, there are 14 possible sets to choose from (probably too many!):\n\nDistance-based (pick districts closest to Fair Haven according to a distance metric)\n\nEuclidean euclid_score\nMahalanobis mah_score\n\nPrincipal Components (pick districts according to similarity across a reduced dimensional space)\n\nPC1 PC1\nPC2 PC2\n\nK-means Clusters (pick districts based on groups derived from the K-means algorithm.\n\nEuclidean distance km_euclid\nMahalanobis distance km_maha\nFirst two principal components (scaled) km_pc_scaled\nFirst two principal components (unscaled) km_pc_unscaled\n\nHierarchical Clusters\n\nEuclidean - Ward hc_euclid_ward\nEuclidean - WPGMA hc_euclid_mcquitty\nPC Scaled - Ward hc_pc_dist_scaled_ward\nPC Scaled - WPGMA hc_pc_dist_scaled_mcquitty\nPC Unscaled - Ward hc_pc_dist_unscaled_ward\nPC Unscaled - WPGMA hc_pc_dist_unscaled_mcquitty\n\n\nThe table below summarizes a selection of district characteristics for the districts that are included in each potential peer set (restricted to PK/K-8th grade). Fair Haven itself is included in the last row for comparison. The Peninsula column is TRUE if FH, Rumson, Little Silver, and Shrewsbury (Peninsula Peers) are all included in that particular peer set.\n\n\nCode - Compare peer sets\nedge_vars &lt;- c(\"Edu_Bach_or_Higher\", \"Fam_Avg_Size\", \"HH_Married_Children\", \"Pop_Under_18\", \"HH_Med_Income\", \"Occ_Mgmt_Bus_Sci_Arts\")\n\npeerset_summary &lt;- bind_rows(\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(euclid_score &lt;= 100) %&gt;%\n    dplyr::summarise(Method=\"Distance - Euclidean\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(mah_score &lt;= 100) %&gt;%\n    dplyr::summarise(Method=\"Distance - Mahalanobis\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::arrange(PC1) %&gt;%\n    dplyr::slice((max(0,fh_pcaid1-30)):(fh_pcaid1+30)) %&gt;%\n    dplyr::summarise(Method=\"Principal Components 1\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::arrange(PC2) %&gt;%\n    dplyr::slice((max(0,fh_pcaid2-25)):(fh_pcaid2+25)) %&gt;%\n    dplyr::summarise(Method=\"Principal Components 2\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(km_euclid) %&gt;%\n    dplyr::summarise(Method=\"K-means (Euclidean)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(km_maha) %&gt;%\n    dplyr::summarise(Method=\"K-means (Mahalanobis)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(km_pc_scaled) %&gt;%\n    dplyr::summarise(Method=\"K-means (PC Scaled)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(km_pc_unscaled) %&gt;%\n    dplyr::summarise(Method=\"K-means (PC Unscaled)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_euclid_ward) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (Euclidean Ward)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_euclid_mcquitty) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (Euclidean WPGMA)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_pc_dist_scaled_ward) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (PC Scaled Ward)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_pc_dist_scaled_mcquitty) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (PC Scaled WPGMA)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_pc_dist_unscaled_ward) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (PC Unscaled Ward)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(hc_pc_dist_unscaled_mcquitty) %&gt;%\n    dplyr::summarise(Method=\"Hierarchical (PC Unscaled WPGMA)\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1))),\n  ccdnjk12_peers %&gt;% \n    dplyr::filter(LEAID==fh_leaid) %&gt;%\n    dplyr::summarise(Method=\"Fair Haven\",\n                     Districts=n(),\n                     Peninsula = all(c(fh_leaid, ls_leaid, rums_leaid, shrews_leaid) %in% LEAID),\n                     across(all_of(edge_vars), \\(x) round(mean(x), 1)))\n)\n  \npeerset_summary %&gt;% \n  dplyr::select(Method, Districts, Peninsula, HH_Med_Income, Edu_Bach_or_Higher, Occ_Mgmt_Bus_Sci_Arts, HH_Married_Children, Fam_Avg_Size) %&gt;%\n  gt(rowname_col = \"Method\") %&gt;%\n   tab_header(\n    title = \"Group Characteristics for Districts in each Peer Set\"\n  ) %&gt;%\n  tab_source_note(\"Data from ACS-EDGE 2018-22.\") %&gt;%\n  opt_interactive()\n\n\n\n\n\nGroup Characteristics for Districts in each Peer Set\n\n\n\n\n\n\nData from ACS-EDGE 2018-22.\n\n\n\n\n\n\n\n\nActually selecting which peer set to use at this point is a combination of art and science. I would like enough districts in the set to provide sufficient variation, but not too many to make comparisons unwieldy - between 35 and 45 should work. Ideally the “Peninsula” peers are already in the set; otherwise I would manually add them in after. It seems like the Hierarchical (Euclidean Ward) set might offer good coverage. A list of these peers can be found above at Section 4.1.4.2, and upon inspection, they do seem reasonable. The group of peers has about 72% of the population with a Bachelor’s degree or higher (FH’s 79%), median household income of $192k (FH’s $230k), and 64% of the population working in management, business, science, or arts (FH’s 60%). From the table, one could argue that that are smaller peer sets that have districts more similar to FH, but I will proceed with the hierarchical cluster-generated solution.\nThis concludes the section on peer set generation for Fair Haven."
  },
  {
    "objectID": "research/building_a_dataset.html#comparing-peer-sets",
    "href": "research/building_a_dataset.html#comparing-peer-sets",
    "title": "Building a dataset",
    "section": "Comparing Peer Sets",
    "text": "Comparing Peer Sets"
  },
  {
    "objectID": "issues.html",
    "href": "issues.html",
    "title": "Issues",
    "section": "",
    "text": "My commitment is to address the key issues facing our schools with thoughtful consideration and a focus on what’s best for our students."
  },
  {
    "objectID": "issues.html#fiscal-responsibility",
    "href": "issues.html#fiscal-responsibility",
    "title": "Issues",
    "section": "Fiscal Responsibility",
    "text": "Fiscal Responsibility\nOur district faces significant budget challenges, and we must approach them with transparency and data-driven decision-making. My experience in research and data analysis will be invaluable in ensuring that every dollar spent directly benefits our students’ educational experience. We will prioritize maintaining essential programs and personnel, while exploring innovative solutions to optimize resource allocation and improve operational efficiencies. We must be thoughtful stewards of taxpayer dollars, focusing on long-term sustainability and the highest return on educational investment. I will work to ensure that any necessary cuts are made strategically, minimizing impact on student learning and maximizing equitable access to educational opportunities."
  },
  {
    "objectID": "issues.html#improving-communication-and-transparency",
    "href": "issues.html#improving-communication-and-transparency",
    "title": "Issues",
    "section": "Improving Communication and Transparency",
    "text": "Improving Communication and Transparency\nEffective communication and transparency are vital for a strong school community. I will advocate for proactive, open dialogue between the Board, administration, teachers, parents, and students. We need to establish clear, accessible channels for sharing information about district policies, budget decisions, and academic progress. I will work to ensure that Board meetings are informative and accessible, and that community feedback is actively sought and valued. Building trust through clear and consistent communication is essential for fostering a collaborative and supportive learning environment."
  },
  {
    "objectID": "issues.html#academic-statement",
    "href": "issues.html#academic-statement",
    "title": "Issues",
    "section": "Academic Statement",
    "text": "Academic Statement\nOur academic focus must be on providing a rigorous, well-rounded education that prepares all students for success in high school and beyond. I am committed to a curriculum that emphasizes critical thinking, problem-solving, and a deep understanding of core subjects. I will support the district’s efforts to align curriculum from Kindergarten through 8th grade, focusing on evidence-based practices and data-driven improvements. I will champion the articulation of curriculum and expectations with Rumson and RFH, ensuring a seamless transition for our students. Furthermore, I will prioritize professional development for our teachers, enabling them to provide differentiated instruction and support all learners, including mid-tier students and those with unique needs. We must foster a culture of continuous improvement, driven by data and a commitment to excellence."
  },
  {
    "objectID": "issues.html#extracurricular-statement",
    "href": "issues.html#extracurricular-statement",
    "title": "Issues",
    "section": "Extracurricular Statement",
    "text": "Extracurricular Statement\nExtracurricular activities and a positive school climate are essential for the social, emotional, and behavioral development of our students. I believe in fostering an inclusive environment that supports the whole child, promoting well-being and a sense of belonging. I will advocate for programs that encourage teamwork, leadership, and personal growth, ensuring that all students have opportunities to participate and thrive. We must prioritize the health, wellness, and safety of our students, providing resources and support to address their social and emotional needs.\n\n\n\n\n\n\n\nTip\n\n\n\nElection day is Tuesday, November 5, 2025."
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "We moved to Fair Haven in early 2021 during the Pandemic in search of a family-oriented community down the shore with excellent schools and in commuting distance to NYC. Fair Haven certainly fit the bill. Fast forward a few years and we are fully integrated into the FH community, with a first grader and pre-K-er both at Sickles.\nProfessionally, I spent the first half of my career working in education and related industries. During college, I worked as a research assistant at the Cornell Higher Education Research Institute (CHERI) studying determinants of faculty productivity. Shortly after, I spent a year at a policy evaluation firm measuring the impacts of federally funded early childhood centers. I then entered graduate school at Teachers College, Columbia University to pursue a degree in economics and education while working at the Community College Research Center (CCRC). A few years in, I decided that I needed some more grounded experience, and took two years off to be a mathematics and statistics teacher at a growing American school in Cancún, Mexico. I eventually returned to New York City and Columbia to finish graduate school before venturing out into the world of EdTech, where I worked as a researcher and data scientist at several startups. I’ve since left the education world professionally, but am still focused on research, data, and decision-making as a quantitative user experience researcher at a global technology company.\nAs I have been following the current Fair Haven district budget situation, and thinking about the long-term investments that me and my family are making in the community, it seemed like a natural next step to get more involved and to contribute a data-driven, outcome-oriented voice to these important issues facing our community and schools. My schooling, research, and work experience have given me the tools needed to meet this opportunity head on, and I am excited to get started.\nFor more info, check out my resume or Google Scholar profile."
  },
  {
    "objectID": "about.html#background-and-why-im-running",
    "href": "about.html#background-and-why-im-running",
    "title": "About",
    "section": "",
    "text": "We moved to Fair Haven in early 2021 during the Pandemic in search of a family-oriented community down the shore with excellent schools and in commuting distance to NYC. Fair Haven certainly fit the bill. Fast forward a few years and we are fully integrated into the FH community, with a first grader and pre-K-er both at Sickles.\nProfessionally, I spent the first half of my career working in education and related industries. During college, I worked as a research assistant at the Cornell Higher Education Research Institute (CHERI) studying determinants of faculty productivity. Shortly after, I spent a year at a policy evaluation firm measuring the impacts of federally funded early childhood centers. I then entered graduate school at Teachers College, Columbia University to pursue a degree in economics and education while working at the Community College Research Center (CCRC). A few years in, I decided that I needed some more grounded experience, and took two years off to be a mathematics and statistics teacher at a growing American school in Cancún, Mexico. I eventually returned to New York City and Columbia to finish graduate school before venturing out into the world of EdTech, where I worked as a researcher and data scientist at several startups. I’ve since left the education world professionally, but am still focused on research, data, and decision-making as a quantitative user experience researcher at a global technology company.\nAs I have been following the current Fair Haven district budget situation, and thinking about the long-term investments that me and my family are making in the community, it seemed like a natural next step to get more involved and to contribute a data-driven, outcome-oriented voice to these important issues facing our community and schools. My schooling, research, and work experience have given me the tools needed to meet this opportunity head on, and I am excited to get started.\nFor more info, check out my resume or Google Scholar profile."
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Peter M. Crosta",
    "section": "",
    "text": "Welcome to my campaign website! I’m Peter M. Crosta, and I’m running for the Fair Haven Board of Education in 2025 because I believe in a data-driven, outcome-oriented approach to ensuring the best possible education for all Fair Haven students.\n[photo coming!]\nBorn and raised in New Jersey, I spent formative summers on the Bayshore before making Fair Haven home in 2021 with my wife, Sarah, and our two children (ages 4 and 7) who are currently enrolled at Sickles Elementary School. I have expertise in educational evaluation and policy analysis, having earned a PhD in economics of education from Columbia University, and I spent a decade conducting research on higher-ed institutions serving diverse student populations. My vision for Fair Haven schools is to ensure every child has access to a high-quality education that prepares them for success in a rapidly-changing world. My research has given me a deep understanding of resource allocation challenges in educational settings, which will be invaluable in addressing Fair Haven’s budget constraints and ensuring all students have the support they need. Beyond my professional experience, I also volunteer on the board of Fair Haven Rec Soccer. When not enjoying the beach with my family or watching the kids play soccer at Fair Haven fields, I work as a user experience researcher for a global technology company."
  },
  {
    "objectID": "research.html",
    "href": "research.html",
    "title": "Research and Analysis",
    "section": "",
    "text": "As part of my commitment to being data-driven and outcome-oriented, I’ll share examples of research, data analysis, and related insights on this page.\n\nBuilding a dataset: combining education data from state and federal sources; creation of a set of peer districts for Fair Haven.\nEnrollment trends: short doc showcasing enrollment trends for Fair Haven and peer districts from 2011-12 to 2023-24.\nInputs and outputs: Exploratory data analysis to understand how Fair Haven compares to peers across a range of educational inputs and outputs."
  },
  {
    "objectID": "research/enrollment_trends.html",
    "href": "research/enrollment_trends.html",
    "title": "Enrollment trends",
    "section": "",
    "text": "Introduction\nStudent enrollment in a district is a core driver of the cost of delivering education, and is a core component in how some school funding, like state aid, is delivered. Across New Jersey, there have been several examples of districts that have seen declining enrollments. Most notably, our northern neighbor Middletown recently announced a provisional plan to close two elementary schools largely due to declining enrollments and increasing costs. Years of declining student counts in neighboring Rumson and Little Silver has also been noted as the primary factor behind their much higher observed spending-per-pupil than districts like Fair Haven.\nTo better understand these trends, I turn to some data on district enrollments from the NJ Department of Education. Details on the data source used can be found here. The specific questions addressed in this document include:\n\nWhat have enrollment trends looked like in Fair Haven over the past decade?\nHow have total enrollments in Fair Haven compared to peninsula districts?\nHow have total enrollments in Fair Haven compared to other similar districts?\n\n\n\n\n\n\n\nNote\n\n\n\nThis document is not meant to be an academic analysis of enrollment patterns. Rather, I wrote it to assist my own understanding of some of the issues and circumstances that impact Fair Haven schools, and as a way to understand one aspect of Fair Haven’s experience relative to peers.\n\n\n\n\nCode - Load libraries\noptions(width = 120)\n\nlibrary(tidyverse)\nlibrary(cluster)\nlibrary(MASS)\nlibrary(ggpmisc)\nlibrary(ggrepel)\nlibrary(glue)\nlibrary(DT)\nlibrary(factoextra)\nlibrary(gt)\nlibrary(purrr)\n\nset.seed(2024)\n\n# Commonly used State ID numbers (staid) and Federal Local Education Authority (LEA) IDs\n# for FH, Little Silver, Rumson, and Shrewsbury\nfh_leaid &lt;- \"3404950\"\nfh_staid &lt;- \"NJ-251440\"\n\nls_leaid &lt;- \"3408790\"\nls_staid &lt;- \"NJ-252720\"\n\nrums_leaid &lt;- \"3414370\"\nrums_staid &lt;- \"NJ-254570\"\n\nshrews_leaid &lt;- \"3414970\"\nshrews_staid &lt;- \"NJ-254770\"\n\ndistrict_name_colors &lt;- c(\n  \"Fair Haven Boro\" = \"#4169E1\",\n  \"Little Silver Boro\" = \"#1F2868\",\n  \"Rumson Boro\" = \"#8640C4\",\n  \"Shrewsbury Boro\" = \"#004500\",\n  \"Other\" = \"darkgrey\"\n)\n\ndistrict_stleaid_colors &lt;-  c(\"#4169E1\", \"#1F2868\", \"#8640C4\", \"#004500\", \"lightgrey\")\nnames(district_stleaid_colors) &lt;-c(fh_staid, ls_staid, rums_staid, shrews_staid, \"Other\")\n\nknitr::opts_chunk$set(\n    fig.width = 8,    \n    fig.height = 10,\n    fig.align = \"center\"\n)\n\n\n\n\nCode - Load enrollment data\ncomb2324 &lt;- read_csv(\"datasets/comb2324.csv\")\nenr_all &lt;- read_csv(\"datasets/enr_all.csv\")\n\n# Attach peer set to enrollment data set\nenr_all$hc_euclid_ward &lt;- enr_all$ST_LEAID %in% comb2324$ST_LEAID[comb2324$hc_euclid_ward]\n\n# Set up colors\nenr_all &lt;- enr_all %&gt;%\n  dplyr::mutate(dist_colors = case_when(\n    ST_LEAID %in% names(district_stleaid_colors) ~ ST_LEAID,\n    TRUE ~ \"Other\"\n  ))\n\n\n\n\nFair Haven\n\n\nCode - Enrollment trends for FH\nenr_all %&gt;%\n  dplyr::filter(ST_LEAID==fh_staid) %&gt;%\n  \n  {\n    ggplot(data=., aes(x=SchoolYear, y=TotalEnrollment, group=ST_LEAID, color=dist_colors)) +\n             geom_line(aes(alpha = 1), linewidth = 1) +\n             geom_point(aes(alpha = 1), size = 4) +\n             scale_x_discrete(expand = c(.2, .2), labels = sort(unique(.$SchoolYear))) +\n             scale_y_continuous(n.breaks = 10) +\n             geom_point(color = \"#FFFFFF\", size = 1) +\n             geom_text(data = . %&gt;% filter(SchoolYear == \"2023-2024\"),\n             aes(label = gsub(\" School District\", \"\", DistrictName), x = 13.5) , hjust = 0.15, fontface = \"bold\", color = \"#888888\", size = 2) +\n             labs(x = \"\", y = \"\", title = \"Total Enrollments in Fair Haven\", subtitle = \"\") +\n             theme_minimal() +\n             theme(axis.text.x = element_text(size=9, vjust=1, hjust=1, color = \"black\", angle = 30)) +\n             theme(panel.grid.major.y = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.y = element_blank()) +\n             theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.x = element_blank()) +\n             scale_color_manual(values=district_stleaid_colors, guide=\"none\") +\n             scale_alpha(guide=\"none\")\n  }\n\n\n\n\n\n\n\n\nFigure 1: District Enrollments for Fair Haven\n\n\n\n\n\nAs seen in Figure 1, Fair Haven has seen a general decline in total enrollments since the 2012-13 school year, from 1041 students to 956 students in 2023-24. In the last 10 years, Fair Haven has seen an overall decline of 5.9%.\n\n\nFair Haven and Peninsula Peers\nFigure 2 adds the Peninsula peers, and as the axes change, it becomes visually apparent that the decline in the number of Fair Haven students is not as large as declines seen in neighboring Rumson, Little Silver, and Shrewsbury, all of whom saw step-change declines during the Covid years of 2019-20 to 2020-21.\n\n\nCode - Enrollment trends for FH and Peninsula\nenr_all %&gt;%\n  dplyr::filter(ST_LEAID %in% names(district_stleaid_colors)[1:4], TotalEnrollment &lt; 1500) %&gt;%\n  \n  {\n    ggplot(data=., aes(x=SchoolYear, y=TotalEnrollment, group=ST_LEAID, color=dist_colors)) +\n             geom_line(aes(alpha = 1), linewidth = 1) +\n             geom_point(aes(alpha = 1), size = 4) +\n             scale_x_discrete(expand = c(.2, .2), labels = sort(unique(.$SchoolYear))) +\n             scale_y_continuous(n.breaks = 10) +\n             geom_point(color = \"#FFFFFF\", size = 1) +\n             geom_text(data = . %&gt;% filter(SchoolYear == \"2023-2024\"),\n                       aes(label = gsub(\" School District\", \"\", DistrictName), x = 13.5) , hjust = 0.1, fontface = \"bold\", color = \"#888888\", size = 2) +\n             labs(x = \"\", y = \"\", title = \"Total Enrollments for FH and Peninsula Peers\", subtitle = \"\") +\n             theme_minimal() +\n             theme(axis.text.x = element_text(size=9, vjust=1, hjust=1, color = \"black\", angle = 30)) +\n             scale_color_manual(values=district_stleaid_colors, guide=\"none\") +\n             scale_alpha(guide=\"none\") +\n             theme(panel.grid.major.y = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.y = element_blank()) +\n             theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 2: District Enrollments for Fair Haven and Peninsula\n\n\n\n\n\n\n\nFair Haven and Peers\nTo be sure, Figure 3 shows Fair Haven and the other 36 peers in our peer set. The red line sloping downwards suggests a general trend of declining enrollments over time over the time period.\n\n\nCode - Enrollment trends for Fair Haven and Peers\nenr_all %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  \n  {\n    ggplot(data=., aes(x=SchoolYear, y=TotalEnrollment, group=ST_LEAID, color=dist_colors)) +\n             geom_line(aes(alpha = 1), linewidth = 1) +\n             geom_point(aes(alpha = 1), size = 2) +\n             scale_x_discrete(expand = c(.2, .2), labels = sort(unique(.$SchoolYear))) +\n             scale_y_continuous(n.breaks = 10) +\n             geom_smooth(aes(group=NA), method=\"lm\", color=\"red\", linewidth=.7) +\n             geom_text_repel(data = . %&gt;% filter(SchoolYear == \"2023-2024\"),\n                       aes(label = gsub(\" School District\", \"\", DistrictName), x = 13) , \n                       hjust = -1, fontface = \"bold\", color = \"#888888\", size = 2,\n                       direction = \"y\",\n                      ylim = c(-Inf, Inf), # Allow movement in the entire vertical range\n                      #xlim = c(NA, NA)\n                      ) +\n             labs(x = \"\", y = \"\", title = \"Total Enrollments for FH and Peers\", subtitle = \"\") +\n             theme_minimal() +\n             theme(axis.text.x = element_text(size=9, vjust=1, hjust=1, color = \"black\", angle = 30)) +\n             scale_color_manual(values=district_stleaid_colors, guide=\"none\") +\n             scale_alpha(guide=\"none\") +\n             theme(panel.grid.major.y = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.y = element_blank()) +\n             theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 3: District Enrollments for Fair Haven and Peers\n\n\n\n\n\nAnother way to look at this is through year-over-year changes in enrollment. Figure 4 shows the percent change from year to year for Fair Haven and peers. The dip in 2020-21 becomes more exaggerated here. Also of note is how Fair Haven, compared to peers, has generally seen less extreme changes from year to year.\n\n\nCode - Enrollment Deltas for FH and Peers\nenr_all %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::arrange(ST_LEAID, SchoolYear) %&gt;%\n  dplyr::group_by(ST_LEAID) %&gt;%\n  dplyr::mutate(EnrDiff= TotalEnrollment - lag(TotalEnrollment, default = first(TotalEnrollment))) %&gt;%\n  dplyr::mutate(PercentChange = (TotalEnrollment - lag(TotalEnrollment)) / lag(TotalEnrollment)) %&gt;%\n  \n  {\n  ggplot(data=., aes(x=SchoolYear, y=PercentChange, group=ST_LEAID, color=dist_colors)) +\n             geom_line(aes(alpha = 1), linewidth = 1) +\n             geom_point(aes(alpha = 1), linewidth = 4) +\n             scale_x_discrete(expand = c(.2, .2), labels = sort(unique(.$SchoolYear))) +\n             scale_y_continuous(n.breaks = 10, label = scales::label_percent(accuracy=1)) +\n             geom_point(color = \"#FFFFFF\", size = 1) +\n              geom_text_repel(data = . %&gt;% filter(SchoolYear == \"2023-2024\", ST_LEAID %in% names(district_stleaid_colors)[1:4]),\n                       aes(label = gsub(\" School District\", \"\", DistrictName), x = 13) , \n                       hjust = -1, fontface = \"bold\", color = \"#888888\", size = 2,\n                       direction = \"y\",\n                      ylim = c(-Inf, Inf), # Allow movement in the entire vertical range\n                      #xlim = c(NA, NA)\n                      ) +\n             labs(x = \"\",\n                  y = \"\",\n                  title = \"Total Enrollment YoY% Changes\",\n                  subtitle = \"\") +\n             theme_minimal() +\n             theme(axis.text.x = element_text(size=9, vjust=1, hjust=1, color = \"black\", angle = 30)) +\n             scale_color_manual(values=district_stleaid_colors, guide=\"none\") +\n             scale_alpha(guide=\"none\") +\n             geom_hline(yintercept = 0, color=\"red\") +\n             theme(panel.grid.major.y = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.y = element_blank()) +\n             theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n             theme(panel.grid.minor.x = element_blank()) +\n             coord_cartesian(ylim = c(-.1, .1))\n  }\n\n\n\n\n\n\n\n\nFigure 4: District Enrollment Deltas for FH and Peers\n\n\n\n\n\nFinally, it is worth noting that there are some districts that have grown in the past ten years and others that have shrunk. For example, Table 1 shows that between 2013-14 and 2023-24, districts such as Spring Lake and Tewksbury have contracted 42% and 29%, respectively. Essex Fells and Edgewater have grown by 21% and 12%, respectively.\n\n\nCode - 10-year District Enrollment Change\ntenyear &lt;- enr_all %&gt;%\n    dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n    pivot_wider(names_from = \"SchoolYear\", values_from = \"TotalEnrollment\", id_cols = \"ST_LEAID\") %&gt;%\n    dplyr::mutate(Change = `2023-2024`/`2013-2014` - 1) %&gt;% \n    dplyr::arrange(Change) %&gt;%\n    dplyr::select(ST_LEAID, `2023-2024`, `2013-2014`, Change)\n \ntenyear$DistrictName = gsub(\" School District\", \"\", comb2324$DistrictName[match(tenyear$ST_LEAID, comb2324$ST_LEAID)])\n\ntenyear %&gt;% \n  dplyr::select(DistrictName, `2023-2024`, `2013-2014`, Change) %&gt;%\n   gt() %&gt;%\n   fmt_percent(\n    columns = Change,\n    decimals = 1\n  ) %&gt;%\n   tab_header(\n    title = \"Enrollment Changes from 2013-14 to 2023-24\",\n    subtitle = \"Fair Haven and Peers\"\n  ) %&gt;%\n  tab_source_note(\"Data from NJ Dept of Education.\") %&gt;%\n  opt_interactive(page_size_default = 5)\n\n\n\n\nTable 1\n\n\n\n\n\n\nEnrollment Changes from 2013-14 to 2023-24\nFair Haven and Peers\n\n\n\n\n\nData from NJ Dept of Education.\n\n\n\n\n\n\n\n\n\n\n\n\n\nConclusion\nThe goal of this short document was to surface some data on enrollment trends in Fair Haven and peers. It is clear that, although enrollment have generally been declining in Fair Haven, the district did not see the sharper permanent declines as Peninsula Peers saw during the Covid. In addition, Fair Haven is neither rapidly growing nor shrinking like other peer districts."
  },
  {
    "objectID": "research/inputs_outputs.html",
    "href": "research/inputs_outputs.html",
    "title": "Inputs and Outputs",
    "section": "",
    "text": "This document contains comparative data on educational inputs and outcomes for Fair Haven and peer districts. Inputs include items such as teacher characteristics and per pupil expenditures. Outcomes are primarily oriented around standardized test scores. It is important to note that often what we can measure or what available measurements we have are not always the measurements that we might want or measurements at the right granularity. That said, I think it is still worth exploring the available data so that we can learn something about the production of education.\n\n\n\n\n\n\nCaution\n\n\n\nUnder construction. This doc only contains plots right now. Annotations are coming soon.\n\n\n\n\nCode - Load libraries\noptions(width = 120)\n\nlibrary(tidyverse)\nlibrary(cluster)\nlibrary(MASS)\nlibrary(ggpmisc)\nlibrary(ggrepel)\nlibrary(glue)\nlibrary(DT)\nlibrary(factoextra)\nlibrary(gt)\nlibrary(purrr)\n\nset.seed(2024)\n\n# Commonly used State ID numbers (staid) and Federal Local Education Authority (LEA) IDs\n# for FH, Little Silver, Rumson, and Shrewsbury\nfh_leaid &lt;- \"3404950\"\nfh_staid &lt;- \"NJ-251440\"\n\nls_leaid &lt;- \"3408790\"\nls_staid &lt;- \"NJ-252720\"\n\nrums_leaid &lt;- \"3414370\"\nrums_staid &lt;- \"NJ-254570\"\n\nshrews_leaid &lt;- \"3414970\"\nshrews_staid &lt;- \"NJ-254770\"\n\ndistrict_name_colors &lt;- c(\n  \"Fair Haven Boro\" = \"#4169E1\",\n  \"Little Silver Boro\" = \"#1F2868\",\n  \"Rumson Boro\" = \"#8640C4\",\n  \"Shrewsbury Boro\" = \"#004500\",\n  \"Other\" = \"darkgrey\"\n)\n\ndistrict_stleaid_colors &lt;-  c(\"#4169E1\", \"#1F2868\", \"#8640C4\", \"#004500\", \"lightgrey\")\nnames(district_stleaid_colors) &lt;-c(fh_staid, ls_staid, rums_staid, shrews_staid, \"Other\")\n\nknitr::opts_chunk$set(\n    fig.width = 8,    \n    fig.height = 10,\n    fig.align = \"center\"\n)\n\nsy &lt;- \"SY2023-24\"\n\n\n\n\nCode - Load data\ncomb2324 &lt;- read_csv(\"datasets/comb2324.csv\")\n\ncomb2324 &lt;- comb2324 %&gt;%\n  dplyr::mutate(\n    TotalEnrollment=as.numeric(TotalEnrollment),\n    student_teacher_ratio = as.numeric(student_teacher_ratio),\n    student_admin_ratio = as.numeric(student_admin_ratio),\n    TeacherAvgYearsExp_School = as.numeric(TeacherAvgYearsExp_School),\n    TeacherAvgYearsExpInDistrict_School = as.numeric(TeacherAvgYearsExpInDistrict_School),\n    PercentageOfOutOfFieldTeachers = as.numeric(PercentageOfOutOfFieldTeachers)/100,\n    PercentageTeachersWithProvisionalCredentials_School =as.numeric(PercentageTeachersWithProvisionalCredentials_School)/100,\n    Chronic_Abs_Pct = as.numeric(Chronic_Abs_Pct)/100,\n    `Students with Disabilities`=as.numeric(`Students with Disabilities`)/100,\n    MATH_ME_District=MATH_ME_District/100,\n    MATH_ME_District_notdis=MATH_ME_District_notdis/100,\n    MATH_ME_District_dis=MATH_ME_District_dis/100,\n    ELA_ME_District=ELA_ME_District/100,\n    ELA_ME_District_notdis=ELA_ME_District_notdis/100,\n    ELA_ME_District_dis=ELA_ME_District_dis/100)\n\nrc_all_comb &lt;- read_csv(\"datasets/rc_all_comb.csv\")\n\noutcomes_time &lt;- rc_all_comb %&gt;% \n  dplyr::select(ST_LEAID, SchoolYear, DistrictName, ELA_ME_District, MATH_ME_District, disab_pct=`Students with Disabilities`,\n                TotalEnrollment, mSGP_ELA, mSGP_Math, ELA_ME_District_dis, ELA_ME_District_notdis,\n                MATH_ME_District_dis, MATH_ME_District_notdis, MATH_pct_level5, MATH_pct_level5_nogr8, \n                ELA_pct_level5, Chronic_Abs_Pct) %&gt;%\n  dplyr::mutate(\n      SchoolYear = ifelse(SchoolYear==\"2023-24\", \"2023-2024\", SchoolYear),\n    year=case_when(\n      SchoolYear == \"2014-2015\" ~ 1,\n      SchoolYear == \"2015-2016\" ~ 2,\n      SchoolYear == \"2016-2017\" ~ 3,\n      SchoolYear == \"2017-2018\" ~ 4,\n      SchoolYear == \"2018-2019\" ~ 5,\n      SchoolYear == \"2019-2020\" ~ 6,\n      SchoolYear == \"2020-2021\" ~ 7,\n      SchoolYear == \"2021-2022\" ~ 8,\n      SchoolYear == \"2022-2023\" ~ 9,\n      SchoolYear == \"2023-2024\" ~ 10,\n    ),\n    Chronic_Abs_Pct = as.numeric(Chronic_Abs_Pct)/100,\n    disab_pct=as.numeric(disab_pct)/100,\n    MATH_ME_District=as.numeric(MATH_ME_District)/100,\n    MATH_ME_District_notdis=as.numeric(MATH_ME_District_notdis)/100,\n    MATH_ME_District_dis=as.numeric(MATH_ME_District_dis)/100,\n    ELA_ME_District=as.numeric(ELA_ME_District)/100,\n    ELA_ME_District_notdis=as.numeric(ELA_ME_District_notdis)/100,\n    ELA_ME_District_dis=as.numeric(ELA_ME_District_dis)/100,\n    TotalEnrollment = as.numeric(TotalEnrollment)\n    ) %&gt;%\n  dplyr::filter(ST_LEAID %in% comb2324$ST_LEAID[comb2324$hc_euclid_ward & comb2324$TotalEnrollment &lt;1500])\n\n#disab_pct is missing for 2014-15\noutcomes_time &lt;- outcomes_time %&gt;% dplyr::rename(stleaid=ST_LEAID)\noutcomes_time$dist_colors &lt;- comb2324$dist_colors[match(outcomes_time$stleaid, comb2324$ST_LEAID)]\noutcomes_time$dist_size &lt;- if_else(outcomes_time$dist_colors==\"Other\", .5, 2)"
  },
  {
    "objectID": "research/inputs_outputs.html#math",
    "href": "research/inputs_outputs.html#math",
    "title": "Inputs and Outputs",
    "section": "Math",
    "text": "Math\n\n\nCode - Math Outcomes\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, MATH_ME_District)) %&gt;%\n  {\n    ggplot(data=., aes(x=MATH_ME_District, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in Math\", y=\"\") +\n      ggtitle(\"Meets/Exceeds Math\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(MATH_ME_District, accuracy = .1), x=MATH_ME_District), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 13: Math Outcomes\n\n\n\n\n\n\n\nCode - Math Outcomes - Exceeds\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, MATH_pct_level5)) %&gt;%\n  {\n    ggplot(data=., aes(x=MATH_pct_level5, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Exceeds in Math\", y=\"\") +\n      ggtitle(\"Exceeds Math\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(MATH_pct_level5, accuracy = .1), x=MATH_pct_level5), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 14: Math Outcomes - Exceeds\n\n\n\n\n\n\n\nCode - Math Median Growth\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, mSGP_Math)) %&gt;%\n  {\n    ggplot(data=., aes(x=mSGP_Math, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Math Median Growth Percentile\", y=\"\") +\n      ggtitle(\"Math Median Growth\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=mSGP_Math, x=mSGP_Math), size=2.5, hjust=-.1) +\n      scale_x_continuous(expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 15: Math Median Growth\n\n\n\n\n\n\n\nCode - Math Outcomes - without Disabilities\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, MATH_ME_District_notdis)) %&gt;%\n  {\n    ggplot(data=., aes(x=MATH_ME_District_notdis, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in Math\", y=\"\") +\n      ggtitle(\"Meets/Exceeds Math - Students without Disabilities\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(MATH_ME_District_notdis, accuracy = .1), x=MATH_ME_District_notdis), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 16: Math Outcomes - without Disabilities\n\n\n\n\n\n\n\nCode - Math Outcomes - Disabilities\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500, !is.na(MATH_ME_District_dis)) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, MATH_ME_District_dis)) %&gt;% \n  {\n    ggplot(data=., aes(x=MATH_ME_District_dis, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in Math\", y=\"\") +\n      ggtitle(\"Meets/Exceeds Math - Students with Disabilities\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(MATH_ME_District_dis, accuracy = .1), x=MATH_ME_District_dis), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 17: Math Outcomes - Disabilities\n\n\n\n\n\n\n\nCode - Math Meets/Exceeds over Time\nall_years &lt;- paste(2014:2023, 2015:2024, sep = \"-\")\nyears_vector &lt;- setNames(all_years, 1:10) # Corrected to align names and values\n\n# Use dplyr::full_join with a dummy data frame to ensure all levels are present\ndata_full &lt;- outcomes_time %&gt;%\n  full_join(data.frame(SchoolYear = factor(all_years, levels = all_years)), by = \"SchoolYear\") %&gt;%\n  dplyr::mutate(dist_colors = fct_relevel(dist_colors, rev(unique(outcomes_time$dist_colors))))\n\ndata_full$DistrictName &lt;- str_trim(str_replace_all(comb2324$LEA_NAME, \"School District|Borough|Boro\", \"\")[match(data_full$stleaid, comb2324$ST_LEAID)])\n\n\nggplot(aes(x=SchoolYear, y=MATH_ME_District, group=stleaid, color=dist_colors), data=data_full)  +\n  geom_line(aes(size=dist_size)) +\n  #geom_smooth(aes(group=NA, color=NA), method=\"loess\") +\n  scale_x_discrete(labels = all_years, expand = expansion(add=c(.5,1.5))) +\n  theme_bw() +\n  scale_color_manual(\"District\", values=district_name_colors, labels =c(\"Shrewsbury\", \"Rumson\", \"Little Silver\", \"Fair Haven\", \"Others\"), guide='none')  +\n  labs(title = \"Math % Meets/Exceeds\", subtitle = \"Fair Haven and Peer Districts, 2014-15 to 2023-24\", x=\"School Year\", y=\"Percent Meets/Exceeds\")  +\n  scale_size(guide = 'none', range = c(0.5, 2)) +\n  scale_y_continuous(labels = scales::label_percent(accuracy = 1)) +\n  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +\n  geom_text(data = data_full %&gt;% filter(SchoolYear == \"2023-2024\", dist_colors != \"Other\"),\n            aes(label = DistrictName, x = 10.5) , hjust = 0.3,  color = \"#888888\", size = 3)\n\n\n\n\n\n\n\n\nFigure 18: Math Meets/Exceeds over Time"
  },
  {
    "objectID": "research/inputs_outputs.html#ela",
    "href": "research/inputs_outputs.html#ela",
    "title": "Inputs and Outputs",
    "section": "ELA",
    "text": "ELA\n\n\nCode - ELA Outcomes\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, ELA_ME_District)) %&gt;% \n  {\n    ggplot(data=., aes(x=ELA_ME_District, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in ELA\", y=\"\") +\n      ggtitle(\"Meets/Exceeds ELA\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(ELA_ME_District, accuracy = .1), x=ELA_ME_District), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 19: ELA Outcomes\n\n\n\n\n\n\n\nCode - ELA Outcomes - Exceeds\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500, !is.na(ELA_pct_level5)) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, ELA_pct_level5)) %&gt;%\n  {\n    ggplot(data=., aes(x=ELA_pct_level5, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Exceeds in ELA\", y=\"\") +\n      ggtitle(\"Exceeds ELA\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(ELA_pct_level5, accuracy = .1), x=ELA_pct_level5), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 20: ELA Outcomes - Exceeds\n\n\n\n\n\n\n\nCode - ELA Median Growth\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, mSGP_ELA)) %&gt;%\n  {\n    ggplot(data=., aes(x=mSGP_ELA, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"ELA Median Growth Percentile\", y=\"\") +\n      ggtitle(\"ELA Median Growth\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=mSGP_ELA, x=mSGP_ELA), size=2.5, hjust=-.1) +\n      scale_x_continuous(expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 21: ELA Median Growth\n\n\n\n\n\n\n\nCode - ELA Outcomes - without Disabilities\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, ELA_ME_District_notdis)) %&gt;%\n  {\n    ggplot(data=., aes(x=ELA_ME_District_notdis, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in ELA\", y=\"\") +\n      ggtitle(\"Meets/Exceeds ELA - Students without Disabilities\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(ELA_ME_District_notdis, accuracy = .1), x=ELA_ME_District_notdis), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 22: ELA Outcomes - without Disabilities\n\n\n\n\n\n\n\nCode - ELA Outcomes - Disabilities\ncomb2324 %&gt;%\n  dplyr::filter(hc_euclid_ward, TotalEnrollment &lt; 1500, !is.na(ELA_ME_District_dis)) %&gt;%\n  dplyr::mutate(district_name = fct_reorder(district_name, ELA_ME_District_dis)) %&gt;%\n  {\n    ggplot(data=., aes(x=ELA_ME_District_dis, y=district_name, fill=dist_colors)) +\n      geom_bar(stat=\"identity\", position=\"dodge\") +\n      theme_minimal() +\n      labs(x=\"Percent Meets/Exceeds in ELA\", y=\"\") +\n      ggtitle(\"Meets/Exceeds ELA - Students with Disabilities\", subtitle = paste0(sy, \"; Source: NJ Dept of Ed.\")) +\n      scale_fill_manual(values=district_name_colors, guide=\"none\") +\n      geom_text(aes(label=scales::percent(ELA_ME_District_dis, accuracy = .1), x=ELA_ME_District_dis), size=2.5, hjust=-.1) +\n      scale_x_continuous(labels = scales::label_percent(accuracy = .1), expand = expansion(mult = c(0, 0.1)))  +\n      theme(panel.grid.major.y = element_blank()) +\n      theme(panel.grid.minor.y = element_blank()) +\n      theme(panel.grid.major.x = element_line(color=\"grey97\")) +\n      theme(panel.grid.minor.x = element_blank()) \n  }\n\n\n\n\n\n\n\n\nFigure 23: ELA Outcomes - Disabilities\n\n\n\n\n\n\n\nCode - ELA Meets/Exceeds over Time\nall_years &lt;- paste(2014:2023, 2015:2024, sep = \"-\")\nyears_vector &lt;- setNames(all_years, 1:10) # Corrected to align names and values\n\n# Use dplyr::full_join with a dummy data frame to ensure all levels are present\ndata_full &lt;- outcomes_time %&gt;%\n  full_join(data.frame(SchoolYear = factor(all_years, levels = all_years)), by = \"SchoolYear\") %&gt;%\n  dplyr::mutate(dist_colors = fct_relevel(dist_colors, rev(unique(outcomes_time$dist_colors)))) \n\ndata_full$DistrictName &lt;- str_trim(comb2324$district_name[match(data_full$stleaid, comb2324$ST_LEAID)])\n\nggplot(aes(x=SchoolYear, y=ELA_ME_District, group=stleaid, color=dist_colors), data=data_full)  +\n  geom_line(aes(size=dist_size)) +\n  scale_x_discrete(labels = all_years, expand = expansion(add=c(.5,1.5))) +\n  theme_bw() +\n  scale_color_manual(\"District\", values=district_name_colors, labels =c(\"Shrewsbury\", \"Rumson\", \"Little Silver\", \"Fair Haven\", \"Others\"), guide='none')  +\n  labs(title = \"ELA Percent Meets/Exceeds\", subtitle = \"Fair Haven and Peer Districts, 2014-15 to 2023-24\", x=\"School Year\", y=\"Percent Meets/Exceeds\")  +\n  scale_size(guide = 'none', range = c(0.5, 2)) +\n  scale_y_continuous(labels = scales::label_percent(accuracy = 1)) +\n  theme(axis.text.x = element_text(angle = 30, hjust = 1)) +\n  geom_text(data = data_full %&gt;% filter(SchoolYear == \"2023-2024\", dist_colors != \"Other\"),\n            aes(label = DistrictName, x = 10.5) , hjust = 0.3, color = \"#888888\", size = 3)\n\n\n\n\n\n\n\n\nFigure 24: ELA Meets/Exceeds over Time"
  }
]